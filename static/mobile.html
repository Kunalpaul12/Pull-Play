<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, height=device-height" />
    <title>Sandeep's Wifi</title>
    <link rel="stylesheet" type="text/css" href="./stylesheet/mobile.css">
    <script>
    </script>
</head>
<body>
        <div class="image-upload">
                <label for="file-input">
                    <img id="displayImg"src="../images/mobile/user/user.png"/>
                </label>
                <input id="file-input" type="file" accept="image/*" />

                <form autocomplete="off">
                    <input type='text' id="name" placeholder="Name" onkeypress=nameCheck(event)>
                </form>
            </div>
            <div class="button">
                <label for="mp3" class="label">
                    <img id="songImage" src="../images/mobile/song/song.svg" align='left'/>
                    <label id="songName">Select Song</label>
                </label>
                <input id="mp3" input type="file" accept="audio/*"/>
            </div>
            <div class="button">
                <div style="width:100%;height: 100%;display:flex;align-items: center" class="dedicatedDiv">
                    <label for="dedicated-image" class="labelDedicatedImage">
                        <img id="dedicatedImage" src="../images/mobile/dedicated/dedicated.svg" align='left'/>
                    </label>
                        <input id="dedicated-image" type="file" accept="image/*" />
                    <form autocomplete="off" id="form">
                                <input type='text' id="dedicatedtext" placeholder="Dedicated To" onkeypress=dedicatedCheck(event)>
                    </form>

                </div>
            </div>
            <button type="button" id="sendButton" onclick="send()">
                <img src="../images/mobile/send/send.svg" id="sendImage"/>
            </button>
   
    <script>
       document.getElementById('file-input').addEventListener('change', handleFileSelect, false);
       document.getElementById('dedicated-image').addEventListener('change',dedictedImage, false);
       document.getElementById('mp3').addEventListener('change',mp3Selected,false);
       function handleFileSelect(evt) {
           var file = evt.target.files[0];
           if(file.type.match('image.*')){
            var reader = new FileReader();
            var imgtag = document.getElementById("displayImg");
            reader.onload = function(evt) {
                imgtag.src = evt.target.result;
            };
            reader.readAsDataURL(file);
           }else{
               alert('Please selected the image file')
           }
        }
       function dedictedImage(evt) {
           var file = evt.target.files[0];
           if(file.type.match('image.*')){
            var reader = new FileReader();
            var imgtag = document.getElementById("dedicatedImage");
            reader.onload = function(evt) {
                imgtag.src = evt.target.result;
            };
            reader.readAsDataURL(file);
           }else{
               alert('Please selected the image file')
           }
        }

      function nameCheck(event) {
            if (event.charCode == 13) {
                var name = document.getElementById("name").value
                if(name == ""){alert("Please provied your name")}
                else{event.preventDefault()
                    document.activeElement.blur();
	                 }
                event.preventDefault()
            }
      }   
      function mp3Selected(evt){
          var file = evt.target.files[0];
          if(file.type.match('audio.*')){
              var songName = file.name;
              document.getElementById('songName').innerHTML  = songName.replace('+',"").substring(0,22);
               
          }else{
            alert('Please selected the audio file')
          }
      }
      function dedicatedCheck(evt){
          if(event.charCode == 13){ document.activeElement.blur();event.preventDefault()}
      }
      function send(){
          var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance 
          xmlhttp.open("POST", "/api/post",false);
          xmlhttp.setRequestHeader("Content-Type", "appliation/json");
          xmlhttp.send(JSON.stringify({ name: "kunal",songName:"123" }));
          alert(xmlhttp.status)
          /*var http = new XMLHttpRequest();
          http.open("GET","/api/get",false)
          http.send()
          alert(http.status)*/
      }
    </script>
</body>
</html>